apiVersion: v1
kind: Pod
metadata:
  name: test-pod
  namespace: pvc-chonker-system
spec:
  containers:
  - name: test
    image: busybox
    command: ["/bin/sh"]
    args:
    - -c
    - |
      while true; do
        echo "=== $(date) ==="
        echo "Filesystem info:"
        df -h /data
        echo "Inode info:"
        df -i /data
        echo "Creating large test file with fallocate..."
        fallocate -l 950M /data/testfile 2>/dev/null || dd if=/dev/zero of=/data/testfile bs=1M count=950 2>/dev/null || true
        echo "Current usage after write:"
        df -h /data
        df -i /data
        echo "Sleeping 60s to allow operator to detect..."
        sleep 60
        echo "Cleaning up test file..."
        rm -f /data/testfile
        echo "Usage after cleanup:"
        df -h /data
        echo "Sleeping 30s..."
        sleep 30
      done
    resources:
      requests:
        memory: "64Mi"
        cpu: "100m"
      limits:
        memory: "128Mi"
        cpu: "200m"
    volumeMounts:
    - name: storage
      mountPath: /data
  volumes:
  - name: storage
    persistentVolumeClaim:
      claimName: test-pvc